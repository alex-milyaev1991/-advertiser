import{s as m,a as $}from"./index-CLLq3gts.js";import{d as A,y as c,J as I,o as h,c as g,l as i,w as s,z as t,ag as d,a as M,E as y,a1 as V,a0 as x,v as F,_ as R}from"./index-D50FFBti.js";import{s as T}from"./index-BmUwq4vx.js";import{s as Q}from"./index-ETHR17tF.js";import{s as E}from"./index-BOBEIKV-.js";import{u as j}from"./creatives-CenJREDn.js";import"./index-e7WAjRi9.js";import"./index-CCpiHejS.js";import"./index-Cpde-KwR.js";const B={class:"card"},D={class:"flex justify-content-end"},O={class:"preview-container"},H=["src","onClick"],z=["src"],J=["src"],W=A({__name:"CreativeList",setup(q){const p=j(),f=c(p.creatives),_=c({}),n=c({limit:10,totalRecords:0,currentPage:1}),C=c({global:{value:null,matchMode:d.CONTAINS},id:{value:null,matchMode:d.EQUALS},name:{value:null,matchMode:d.CONTAINS},type:{value:null,matchMode:d.EQUALS},moderation_status:{value:null,matchMode:d.EQUALS}}),w=c(!1),u=c(null),U=c([{label:"Video",value:"video"}]),P=c([{label:"Approved",value:"approved"},{label:"Pending",value:"pending"},{label:"Rejected",value:"rejected"}]),b=async()=>{await p.getCreatives(n.value.limit,n.value.currentPage),f.value=p.creatives,n.value.totalRecords=p.pagination.totalRecords,f.value.forEach(o=>{o.type==="video"&&L(o.file_url,a=>{_.value[o.id]=a})})},L=(o,a)=>{const l=document.createElement("video");l.src=o,l.crossOrigin="anonymous",l.addEventListener("loadeddata",()=>{l.currentTime=1}),l.addEventListener("seeked",()=>{const e=document.createElement("canvas");e.width=l.videoWidth,e.height=l.videoHeight;const r=e.getContext("2d");r&&(r.drawImage(l,0,0,e.width,e.height),a(e.toDataURL("image/jpeg")))}),l.load()},k=o=>{n.value.currentPage=Math.floor(o.first/o.rows)+1,n.value.limit=o.rows,b()},S=o=>{u.value=o,w.value=!0},N=o=>{f.value.sort((a,l)=>o.order===1?a.id-l.id:l.id-a.id)};return I(async()=>{await b()}),(o,a)=>{var l;return h(),g("div",B,[i(t($),{filters:C.value,"onUpdate:filters":a[0]||(a[0]=e=>C.value=e),value:f.value,tableStyle:"min-width: 50rem",paginator:!0,rows:n.value.limit,totalRecords:n.value.totalRecords,showFilterMatchModes:!1,first:(n.value.currentPage-1)*n.value.limit,onPage:k,filterDisplay:"row"},{header:s(()=>[M("div",D,[i(t(y),{as:"router-link",to:"/creatives/create"},{default:s(()=>a[3]||(a[3]=[V("Create Creative")])),_:1})])]),default:s(()=>[i(t(m),{field:"id",header:"ID",sortable:"",filter:!0,filterPlaceholder:"Filter by ID",filterMatchMode:t(d).EQUALS,sortFunction:N},null,8,["filterMatchMode"]),i(t(m),{field:"name",header:"Name",filter:!0,filterPlaceholder:"Filter by Name",filterMatchMode:t(d).CONTAINS,showFilterMatchModes:!1},{filter:s(({filterModel:e,filterCallback:r})=>[i(t(Q),{modelValue:e.value,"onUpdate:modelValue":v=>e.value=v,type:"text",onInput:v=>r(),placeholder:"Search by name"},null,8,["modelValue","onUpdate:modelValue","onInput"])]),_:1},8,["filterMatchMode"]),i(t(m),{header:"Preview"},{body:s(({data:e})=>[M("div",O,[M("img",{src:_.value[e.id],alt:"Preview",class:"thumbnail",onClick:r=>S(e)},null,8,H),i(t(y),{onClick:r=>S(e),class:"ml-2"},{default:s(()=>a[4]||(a[4]=[V("View")])),_:2},1032,["onClick"])])]),_:1}),i(t(m),{field:"type",header:"Creative Type",filter:!0,filterMatchMode:t(d).EQUALS},{filter:s(({filterModel:e,filterCallback:r})=>[i(t(E),{modelValue:e.value,"onUpdate:modelValue":v=>e.value=v,options:U.value,optionLabel:"label",placeholder:"Select Type","option-value":"value",onChange:v=>r()},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1},8,["filterMatchMode"]),i(t(m),{field:"moderation_status",header:"Moderation Status",filter:!0,filterMatchMode:t(d).EQUALS},{filter:s(({filterModel:e,filterCallback:r})=>[i(t(E),{modelValue:e.value,"onUpdate:modelValue":v=>e.value=v,options:P.value,optionLabel:"label","option-value":"value",placeholder:"Select Status",onChange:r},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1},8,["filterMatchMode"]),i(t(m),{header:"Edit"},{body:s(({data:e})=>[i(t(y),{as:"router-link",to:`/creatives/${e.id}`,label:"Edit"},null,8,["to"])]),_:1})]),_:1},8,["filters","value","rows","totalRecords","first"]),i(t(T),{visible:w.value,"onUpdate:visible":a[1]||(a[1]=e=>w.value=e),header:(l=u.value)==null?void 0:l.name,style:{width:"50vw"},onHide:a[2]||(a[2]=e=>u.value=null)},{default:s(()=>[u.value?(h(),g(x,{key:0},[u.value.type!="video"?(h(),g("img",{key:0,src:_.value[u.value.id]||u.value.file_url,class:"large-preview"},null,8,z)):(h(),g("video",{key:1,class:"video-preview",src:u.value.file_url,controls:""},null,8,J))],64)):F("",!0)]),_:1},8,["visible","header"])])}}}),oe=R(W,[["__scopeId","data-v-b1275ee7"]]);export{oe as default};
